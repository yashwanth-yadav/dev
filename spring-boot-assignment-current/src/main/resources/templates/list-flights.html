<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">

<head>
    <title>Air Info</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">


    <style>
      body, html {
      height: 100%;
      margin: 0;
    }

    .bg {
      /* The image used */
      height: 100%;
      background-position: center;
      background-repeat: no-repeat;
      background-size: cover;
<!--      background-color: #e1edf0;-->
    }

  .search {
  overflow: hidden;
  padding: 0 0 1.25em;
  opacity: 0.7;
  cursor: pointer;
  transition-property: opacity;
  transition-duration: .3s;

  &:hover, &:focus-within {
    opacity: 1;
  }
}
text{
font-size:26px;
}
.body2 {
  font-size:24px;
}
</style>

</head>

<body class="bg" style="background: url(https://cdn.theatlantic.com/thumbor/xTU8pHrt5DLCyYvZnneO8mLAAOQ=/0x0:4800x2700/1600x900/media/img/mt/2021/05/ryanair/original.jpg); background-size:100% 100%">
<div class="container">
    <br>
    <h3>Todays Flights...</h3>
    <hr>
    <div>
        <form th:action="@{/logout}" method="post" align="right">
            <input type="submit" value="LOGOUT"></input>
        </form>

        <div sec:authorize="hasRole('ADMIN')">

        <a th:href="@{/flights/showFormForAdd}"
           class="btn btn-success">Add Flight</a>
        </div>
    </div>
    <br>



    <div class="body2">

    <form th:action="@{/flights/search}" method="get">
        <input type="text" name="keyword" th:value="${keyword}"  placeholder="Find by Flight Name or Destination.." size="50">
        <button type="submit" class="btn btn-success btn-sm" >Search</button>
        <button type="submit" class="btn btn-info btn-sm" >Reset</button>
    </form>

    <br>



    <table id="flightTable" class="table align-middle" style="height: 150%;">
        <thead >
            <tr >
                <th>Flight Name</th>
                <th>Arrival Time</th>
                <th>Destination</th>
                <th>Action</th>
            </tr>
        </thead>

        <tbody>
            <tr th:each="tempFlight : ${flights}" >
                <td th:text="${tempFlight.flightName}"/>
                <td th:text="${tempFlight.arrivalTime}"/>
                <td th:text="${tempFlight.gateNo}"/>

<!--                <security:authorize access="hasRole('MANAGER')">-->

<!--                    &lt;!&ndash; Add a link to point to /leaders ... this is for managers &ndash;&gt;-->

<!--                    <p>-->
<!--                        <a href="${pageContext.request.contextPath}/leaders">Leadership Meeting</a>-->
<!--                        (Only for Manager folks)-->
<!--                    </p>-->
<!--                </security:authorize>-->


                <td>
                    <div sec:authorize="hasRole('USER')">
                        You have no authorization to UPDATE or Delete.
                    </div>

                    <div sec:authorize="hasRole('ADMIN')">

                        <a th:href="@{/flights/showFormForUpdate(flightId=${tempFlight.id})}"
                           class="btn btn-info btn-sm">Update</a>

                        <a th:href="@{/flights/delete(flightId=${tempFlight.id})}"
                           class="btn btn-danger btn-sm"
                           onclick="if(!(confirm('Are you sure ?'))) return false">Delete</a>
                    </div>

                </td>

            </tr>
        </tbody>

    </table>
    </div>

<!--    Logged user: <span sec:authentication="name">Bob</span>-->
<!--    Roles: <span sec:authentication="principal.authorities">[ROLE_USER, ROLE_ADMIN]</span>-->

<!--    <span th:text="${#authentication.getPrincipal().getUsername()}"></span>-->
<!--    <span th:text="${#authentication.getPrincipal().authorities}"></span>-->

<!--    <div sec:authorize="hasRole('ADMIN')">-->
<!--        This content is only shown to administrators.§§-->
<!--    </div>-->

<!--    <div sec:authorize="hasRole('USER')">-->
<!--        This content is only shown to users.-->
<!--    </div>-->



</div>

<!--<script th:inline="javascript">-->
<!--    /*<![CDATA[*/-->
<!--        var employees=/*[[${employees}]]*/;-->
<!--    /*]]>*/-->
<!--    $('#txtSearch').on('keyup',function(){-->
<!--        var value=$(this).val();-->
<!--        var data=FilterFunction(value,employees);-->
<!--        rebuildTable(data)-->
<!--    });-->

<!--    function FilterFunction(value,data){-->
<!--        var filteredData=[];-->
<!--        for(var i=0;i<data.length;i++){-->
<!--            value=value.toLowerCase():-->
<!--            var fname=data[i].flightName.toLowerCase();-->
<!--            var lname=data[i].arrivalTime.toLowerCase();-->

<!--            if(fname.includes(value)||lname.includes(value)){-->
<!--                filteredData.push(data[i]);-->
<!--            }-->
<!--        }-->
<!--        return filteredData;-->
<!--    }-->

<!--    function rebuildTable(data){-->
<!--         var table=document.getElementById('flightTable')-->
<!--         table.innerHTML=''-->
<!--         for(var i=0;i<data.length;i++){-->
<!--            var row=`<tr>-->
<!--                <td>${data[i].flightName}</td>-->
<!--                <td>${data[i].arrivalTime}</td>-->
<!--                <td>${data[i].gateNo}</td>-->
<!--                <td>-->
<!--                    <a th:href="@{/flights/showFormForUpdate(employeeId=${data[i].id})}"-->
<!--                       class="btn btn-info btn-sm">Update</a>-->
<!--                </td>-->
<!--                <td>-->
<!--                    <a th:href="@{/flights/delete(employeeId=${data[i].id})}"-->
<!--                       class="btn btn-danger btn-sm"-->
<!--                        onclick="if(!(confirm('Are you sure ?'))) return false">Delete</a>-->
<!--                </td>-->
<!--                </tr>`-->
<!--                table.innerHTML+=row-->
<!--            }-->
<!--     }-->

<!--</script>-->

</body>



</html>